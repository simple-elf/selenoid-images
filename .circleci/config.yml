version: 2
jobs:
  build:
    machine: true
    environment:
      APPIUM: '1.8.1'
      ANDROID: '8.0'
      IMAGE: 'simple1elf/android-chrome'
      CHROME: 'y'
      DRIVER: '2.41'
    steps:
      - checkout
      - run: docker login -u simple1elf -p elektronik777
      - run: |
          cd selenium
          echo -e "$APPIUM\n$ANDROID\nNexus 6\n500\n500" > param.txt
          (if [ "$CHROME" == "y" ]; then echo -e "$CHROME\n$DRIVER" >> param.txt; else echo -e "n\n" >> param.txt; fi)
          echo -e "$IMAGE:$ANDROID\ny\n" >> param.txt
          cat param.txt
          cat param.txt | ./automate_android.sh
          docker push $IMAGE:$ANDROID